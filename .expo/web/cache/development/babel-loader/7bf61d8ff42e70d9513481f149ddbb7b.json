{"ast":null,"code":"import { runOnUIImmediately } from \"../threads\";\nvar _worklet_1814162711565_init_data = {\n  code: \"function anonymous() {\\n  const frameCallbackRegistry = {\\n    frameCallbackRegistry: new Map(),\\n    activeFrameCallbacks: new Set(),\\n    previousFrameTimestamp: null,\\n    nextCallId: 0,\\n    runCallbacks: function (callId) {\\n      var _this = this;\\n      const loop = function (timestamp) {\\n        if (callId !== _this.nextCallId) {\\n          return;\\n        }\\n        if (_this.previousFrameTimestamp === null) {\\n          _this.previousFrameTimestamp = timestamp;\\n        }\\n        const delta = timestamp - _this.previousFrameTimestamp;\\n        _this.activeFrameCallbacks.forEach(function (callbackId) {\\n          const callbackDetails = _this.frameCallbackRegistry.get(callbackId);\\n          const {\\n            startTime: startTime\\n          } = callbackDetails;\\n          if (startTime === null) {\\n            callbackDetails.startTime = timestamp;\\n            callbackDetails.callback({\\n              timestamp: timestamp,\\n              timeSincePreviousFrame: null,\\n              timeSinceFirstFrame: 0\\n            });\\n          } else {\\n            callbackDetails.callback({\\n              timestamp: timestamp,\\n              timeSincePreviousFrame: delta,\\n              timeSinceFirstFrame: timestamp - startTime\\n            });\\n          }\\n        });\\n        if (_this.activeFrameCallbacks.size > 0) {\\n          _this.previousFrameTimestamp = timestamp;\\n          requestAnimationFrame(loop);\\n        } else {\\n          _this.previousFrameTimestamp = null;\\n        }\\n      };\\n      if (this.activeFrameCallbacks.size === 1 && callId === this.nextCallId) {\\n        requestAnimationFrame(loop);\\n      }\\n    },\\n    registerFrameCallback: function (callback, callbackId) {\\n      this.frameCallbackRegistry.set(callbackId, {\\n        callback: callback,\\n        startTime: null\\n      });\\n    },\\n    unregisterFrameCallback: function (callbackId) {\\n      this.manageStateFrameCallback(callbackId, false);\\n      this.frameCallbackRegistry.delete(callbackId);\\n    },\\n    manageStateFrameCallback: function (callbackId, state) {\\n      if (callbackId === -1) {\\n        return;\\n      }\\n      if (state) {\\n        this.activeFrameCallbacks.add(callbackId);\\n        this.runCallbacks(this.nextCallId);\\n      } else {\\n        const callback = this.frameCallbackRegistry.get(callbackId);\\n        callback.startTime = null;\\n        this.activeFrameCallbacks.delete(callbackId);\\n        if (this.activeFrameCallbacks.size === 0) {\\n          this.nextCallId += 1;\\n        }\\n      }\\n    }\\n  };\\n  global._frameCallbackRegistry = frameCallbackRegistry;\\n}\",\n  location: \"/Users/Shoaib/Awesome/node_modules/react-native-reanimated/lib/module/reanimated2/frameCallback/FrameCallbackRegistryUI.js\",\n  sourceMap: \"{\\\"version\\\":3,\\\"names\\\":[\\\"anonymous\\\",\\\"frameCallbackRegistry\\\",\\\"Map\\\",\\\"activeFrameCallbacks\\\",\\\"Set\\\",\\\"previousFrameTimestamp\\\",\\\"nextCallId\\\",\\\"runCallbacks\\\",\\\"callId\\\",\\\"_this\\\",\\\"loop\\\",\\\"timestamp\\\",\\\"delta\\\",\\\"forEach\\\",\\\"callbackId\\\",\\\"callbackDetails\\\",\\\"get\\\",\\\"startTime\\\",\\\"callback\\\",\\\"timeSincePreviousFrame\\\",\\\"timeSinceFirstFrame\\\",\\\"size\\\",\\\"requestAnimationFrame\\\",\\\"registerFrameCallback\\\",\\\"set\\\",\\\"unregisterFrameCallback\\\",\\\"manageStateFrameCallback\\\",\\\"delete\\\",\\\"state\\\",\\\"add\\\",\\\"global\\\",\\\"_frameCallbackRegistry\\\"],\\\"sources\\\":[\\\"/Users/Shoaib/Awesome/node_modules/react-native-reanimated/lib/module/reanimated2/frameCallback/FrameCallbackRegistryUI.js\\\"],\\\"mappings\\\":\\\"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\\\"}\"\n};\nexport var prepareUIRegistry = runOnUIImmediately(function () {\n  var _e = [new global.Error(), 1, -27];\n\n  var _f = function _f() {\n    var frameCallbackRegistry = {\n      frameCallbackRegistry: new Map(),\n      activeFrameCallbacks: new Set(),\n      previousFrameTimestamp: null,\n      nextCallId: 0,\n      runCallbacks: function runCallbacks(callId) {\n        var _this = this;\n\n        var loop = function loop(timestamp) {\n          if (callId !== _this.nextCallId) {\n            return;\n          }\n\n          if (_this.previousFrameTimestamp === null) {\n            _this.previousFrameTimestamp = timestamp;\n          }\n\n          var delta = timestamp - _this.previousFrameTimestamp;\n\n          _this.activeFrameCallbacks.forEach(function (callbackId) {\n            var callbackDetails = _this.frameCallbackRegistry.get(callbackId);\n\n            var startTime = callbackDetails.startTime;\n\n            if (startTime === null) {\n              callbackDetails.startTime = timestamp;\n              callbackDetails.callback({\n                timestamp: timestamp,\n                timeSincePreviousFrame: null,\n                timeSinceFirstFrame: 0\n              });\n            } else {\n              callbackDetails.callback({\n                timestamp: timestamp,\n                timeSincePreviousFrame: delta,\n                timeSinceFirstFrame: timestamp - startTime\n              });\n            }\n          });\n\n          if (_this.activeFrameCallbacks.size > 0) {\n            _this.previousFrameTimestamp = timestamp;\n            requestAnimationFrame(loop);\n          } else {\n            _this.previousFrameTimestamp = null;\n          }\n        };\n\n        if (this.activeFrameCallbacks.size === 1 && callId === this.nextCallId) {\n          requestAnimationFrame(loop);\n        }\n      },\n      registerFrameCallback: function registerFrameCallback(callback, callbackId) {\n        this.frameCallbackRegistry.set(callbackId, {\n          callback: callback,\n          startTime: null\n        });\n      },\n      unregisterFrameCallback: function unregisterFrameCallback(callbackId) {\n        this.manageStateFrameCallback(callbackId, false);\n        this.frameCallbackRegistry.delete(callbackId);\n      },\n      manageStateFrameCallback: function manageStateFrameCallback(callbackId, state) {\n        if (callbackId === -1) {\n          return;\n        }\n\n        if (state) {\n          this.activeFrameCallbacks.add(callbackId);\n          this.runCallbacks(this.nextCallId);\n        } else {\n          var callback = this.frameCallbackRegistry.get(callbackId);\n          callback.startTime = null;\n          this.activeFrameCallbacks.delete(callbackId);\n\n          if (this.activeFrameCallbacks.size === 0) {\n            this.nextCallId += 1;\n          }\n        }\n      }\n    };\n    global._frameCallbackRegistry = frameCallbackRegistry;\n  };\n\n  _f._closure = {};\n  _f.__initData = _worklet_1814162711565_init_data;\n  _f.__workletHash = 1814162711565;\n  _f.__stackDetails = _e;\n  _f.__version = \"3.3.0\";\n  return _f;\n}());","map":{"version":3,"sources":["FrameCallbackRegistryUI.ts"],"names":["runOnUIImmediately","prepareUIRegistry","frameCallbackRegistry","Map","activeFrameCallbacks","Set","previousFrameTimestamp","nextCallId","runCallbacks","callId","loop","timestamp","delta","forEach","callbackId","callbackDetails","get","startTime","callback","timeSincePreviousFrame","timeSinceFirstFrame","size","requestAnimationFrame","registerFrameCallback","set","unregisterFrameCallback","manageStateFrameCallback","delete","state","add","global","_frameCallbackRegistry"],"mappings":"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","sourcesContent":["import { runOnUIImmediately } from '../threads';\n\ntype CallbackDetails = {\n  callback: (frameInfo: FrameInfo) => void;\n  startTime: number | null;\n};\n\nexport type FrameInfo = {\n  timestamp: number;\n  timeSincePreviousFrame: number | null;\n  timeSinceFirstFrame: number;\n};\n\nexport interface FrameCallbackRegistryUI {\n  frameCallbackRegistry: Map<number, CallbackDetails>;\n  activeFrameCallbacks: Set<number>;\n  previousFrameTimestamp: number | null;\n  runCallbacks: (callId: number) => void;\n  nextCallId: number;\n  registerFrameCallback: (\n    callback: (frameInfo: FrameInfo) => void,\n    callbackId: number\n  ) => void;\n  unregisterFrameCallback: (callbackId: number) => void;\n  manageStateFrameCallback: (callbackId: number, state: boolean) => void;\n}\n\nexport const prepareUIRegistry = runOnUIImmediately(() => {\n  'worklet';\n\n  const frameCallbackRegistry: FrameCallbackRegistryUI = {\n    frameCallbackRegistry: new Map<number, CallbackDetails>(),\n    activeFrameCallbacks: new Set<number>(),\n    previousFrameTimestamp: null,\n    nextCallId: 0,\n\n    runCallbacks(callId) {\n      const loop = (timestamp: number) => {\n        if (callId !== this.nextCallId) {\n          return;\n        }\n        if (this.previousFrameTimestamp === null) {\n          this.previousFrameTimestamp = timestamp;\n        }\n\n        const delta = timestamp - this.previousFrameTimestamp;\n\n        this.activeFrameCallbacks.forEach((callbackId: number) => {\n          const callbackDetails = this.frameCallbackRegistry.get(callbackId)!;\n\n          const { startTime } = callbackDetails;\n\n          if (startTime === null) {\n            // First frame\n            callbackDetails.startTime = timestamp;\n\n            callbackDetails.callback({\n              timestamp,\n              timeSincePreviousFrame: null,\n              timeSinceFirstFrame: 0,\n            });\n          } else {\n            // Next frame\n            callbackDetails.callback({\n              timestamp,\n              timeSincePreviousFrame: delta,\n              timeSinceFirstFrame: timestamp - startTime,\n            });\n          }\n        });\n\n        if (this.activeFrameCallbacks.size > 0) {\n          this.previousFrameTimestamp = timestamp;\n          requestAnimationFrame(loop);\n        } else {\n          this.previousFrameTimestamp = null;\n        }\n      };\n\n      // runCallback() should only be called after registering a callback,\n      // so if there is only one active callback, then it means that there were\n      // zero previously and the loop isn't running yet.\n      if (this.activeFrameCallbacks.size === 1 && callId === this.nextCallId) {\n        requestAnimationFrame(loop);\n      }\n    },\n\n    registerFrameCallback(\n      callback: (frameInfo: FrameInfo) => void,\n      callbackId: number\n    ) {\n      this.frameCallbackRegistry.set(callbackId, {\n        callback: callback,\n        startTime: null,\n      });\n    },\n\n    unregisterFrameCallback(callbackId: number) {\n      this.manageStateFrameCallback(callbackId, false);\n      this.frameCallbackRegistry.delete(callbackId);\n    },\n\n    manageStateFrameCallback(callbackId: number, state: boolean) {\n      if (callbackId === -1) {\n        return;\n      }\n      if (state) {\n        this.activeFrameCallbacks.add(callbackId);\n        this.runCallbacks(this.nextCallId);\n      } else {\n        const callback = this.frameCallbackRegistry.get(callbackId)!;\n        callback.startTime = null;\n\n        this.activeFrameCallbacks.delete(callbackId);\n        if (this.activeFrameCallbacks.size === 0) {\n          this.nextCallId += 1;\n        }\n      }\n    },\n  };\n\n  global._frameCallbackRegistry = frameCallbackRegistry;\n});\n"]},"metadata":{},"sourceType":"module"}